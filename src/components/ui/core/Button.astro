---
// Import co-located component styles
import './button.css';

export interface Props {
  variant?: 'solid' | 'outline' | 'ghost';
  color?: 'primary' | 'secondary' | 'destructive';
  size?: 'sm' | 'md' | 'icon';
  shape?: 'square' | 'round' | 'pill';
  disabled?: boolean;
  loading?: boolean;
  type?: 'button' | 'submit' | 'reset';
  href?: string;
  target?: string;
  class?: string;
  [key: string]: any; // Allow any Alpine.js attributes
}

const { 
  variant = 'solid',
  color = 'primary',
  size = 'md',
  shape = 'round',
  disabled = false,
  loading = false,
  type = 'button',
  href,
  target,
  class: className = "",
  ...rest
} = Astro.props;

// Generate CUBE CSS classes
const classes = [
  'btn',
  `color-${color}`,
  `size-${size}`,
  variant !== 'solid' && `variant-${variant}`,
  shape !== 'round' && `shape-${shape}`,
  loading && 'is-loading',
  disabled && 'is-disabled',
  className
].filter(Boolean).join(' ');

const Tag = href ? 'a' : 'button';
const tagProps = href 
  ? { href, target, style: "text-decoration: none;" }
  : { type, disabled: disabled && !loading };
---

<!-- 
TRUE Design System Button Component

Usage:
<Button>Default</Button>
<Button color="destructive" variant="outline">Delete</Button>
<Button size="icon"><Icon /></Button>
<Button variant="outline"><Icon /> New Branch</Button>

Focused Props (covering 80% of use cases):
- variant: solid (default), outline, ghost
- color: primary (default), secondary, destructive  
- size: sm, md (default), icon
- shape: square, round (default), pill
- loading: boolean - shows spinner
- disabled: boolean

For edge cases (more colors, custom shapes) use CSS classes:
<Button class="color-success">Success button</Button>
<Button class="shape-rounded-2xl">Custom shape button</Button>
-->

<Tag 
  class={classes}
  {...tagProps}
  {...rest}
>
  <slot />
</Tag>