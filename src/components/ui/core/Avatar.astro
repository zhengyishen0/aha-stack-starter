---
// Import component styles
import '/src/styles/components/avatar.css';

export interface Props {
  src?: string;
  alt?: string;
  size?: 'sm' | 'md' | 'lg' | 'xl';
  variant?: 'circle' | 'square';
  icon?: string;
  href?: string;
  class?: string;
  [key: string]: any; // Allow any attributes
}

const { 
  src,
  alt = '',
  size = 'md',
  variant = 'circle',
  icon,
  href,
  class: className = "",
  ...rest
} = Astro.props;

// Generate class names using true design system
const getAvatarClasses = () => {
  const baseClass = 'avatar';
  const sizeClass = `avatar-${size}`;
  const variantClass = `avatar-${variant}`;
  
  return `${baseClass} ${sizeClass} ${variantClass} ${className}`.trim();
};

// Determine if we should render as a link
const isLink = !!href;
const Element = isLink ? 'a' : 'div';
---

<!-- 
TRUE Design System Avatar Component

Usage:
<Avatar src="/path/to/image.jpg" alt="User name" size="lg" />
<Avatar icon="/assets/github-icon.svg" variant="circle" size="md" href="https://github.com" />
<Avatar size="sm">
  <span>JD</span>
</Avatar>

Props:
- src: Image source URL
- alt: Alt text for image
- size: 'sm' | 'md' | 'lg' | 'xl' (default: 'md')
- variant: 'circle' | 'square' (default: 'circle')
- icon: SVG icon path
- href: Makes avatar clickable link
- class: Additional CSS classes
- ...rest: Any other attributes
-->

<Element 
  class={getAvatarClasses()} 
  href={isLink ? href : undefined}
  {...rest}
>
  {src && <img src={src} alt={alt} class="avatar-image" />}
  {icon && <img src={icon} alt={alt} class="avatar-icon" />}
  {!src && !icon && <slot />}
</Element>