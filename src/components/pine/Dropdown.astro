---
export interface Props {
  id?: string;
  placement?: 'bottom-start' | 'bottom-end' | 'top-start' | 'top-end';
  class?: string;
  menuClass?: string;
}

const { 
  id = 'dropdown',
  placement = 'bottom-start',
  class: className = "",
  menuClass = ""
} = Astro.props;

const getComponentClasses = () => {
  return 'dropdown';
};

const getMenuClasses = () => {
  return 'dropdown-menu';
};

const placementClasses: { [key: string]: string } = {
  'bottom-start': 'top-full left-0 mt-2',
  'bottom-end': 'top-full right-0 mt-2',
  'top-start': 'bottom-full left-0 mb-2',
  'top-end': 'bottom-full right-0 mb-2'
};
---

<!-- 
Pine UI Dropdown Component

Usage:
<Dropdown placement="bottom-start">
  <div slot="trigger">
    <Button>Open Menu</Button>
  </div>
  
  <div slot="menu">
    <div class="dropdown-header">Account</div>
    <a href="#" class="dropdown-item">Profile</a>
    <a href="#" class="dropdown-item">Settings</a>
    <div class="dropdown-separator"></div>
    <a href="#" class="dropdown-item dropdown-item-danger">Sign out</a>
  </div>
</Dropdown>

Features:
- Click outside to close
- Multiple placement options
- Smooth transitions
- Alpine.js powered
- Design system classes
- Semantic structure
-->

<div 
  x-data="{ dropdownOpen: false }" 
  class={`${getComponentClasses()} ${className}`}
>
  <!-- Trigger -->
  <div class="dropdown-trigger" @click="dropdownOpen = !dropdownOpen">
    <slot name="trigger" />
  </div>
  
  <!-- Menu -->
  <div 
    x-show="dropdownOpen" 
    @click.away="dropdownOpen = false"
    x-transition:enter="transition ease-out duration-100"
    x-transition:enter-start="transform opacity-0 scale-95"
    x-transition:enter-end="transform opacity-100 scale-100"
    x-transition:leave="transition ease-in duration-75"
    x-transition:leave-start="transform opacity-100 scale-100"
    x-transition:leave-end="transform opacity-0 scale-95"
    class={`${getMenuClasses()} ${placementClasses[placement]} ${menuClass}`}
    x-cloak
  >
    <slot name="menu" />
  </div>
</div>