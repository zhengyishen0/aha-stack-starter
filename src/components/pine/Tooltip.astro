---
export interface Props {
  content: string;
  position?: 'top' | 'right' | 'bottom' | 'left';
  showArrow?: boolean;
  delay?: number;
  class?: string;
  tooltipClass?: string;
}

const { 
  content,
  position = 'top',
  showArrow = true,
  delay = 0,
  class: className = "",
  tooltipClass = ""
} = Astro.props;

const positionClasses: { [key: string]: string } = {
  'top': 'bottom-full left-1/2 transform -translate-x-1/2 mb-2',
  'right': 'left-full top-1/2 transform -translate-y-1/2 ml-2',
  'bottom': 'top-full left-1/2 transform -translate-x-1/2 mt-2',
  'left': 'right-full top-1/2 transform -translate-y-1/2 mr-2'
};

const arrowClasses: { [key: string]: string } = {
  'top': 'top-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-gray-800',
  'right': 'right-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-gray-800',
  'bottom': 'bottom-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-t-transparent border-b-gray-800',
  'left': 'left-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-gray-800'
};
---

<!-- 
Pine UI Tooltip Component

Usage:
<Tooltip content="This is a helpful tooltip" position="top" showArrow={true}>
  <Button>Hover me</Button>
</Tooltip>

Features:
- Multiple positions (top, right, bottom, left)
- Optional arrow
- Configurable delay
- Hover triggers
- Alpine.js powered
-->

<div 
  x-data={`{
    tooltipVisible: false,
    tooltipText: '${content}',
    tooltipArrow: ${showArrow},
    tooltipPosition: '${position}',
    tooltipDelay: ${delay}
  }`}
  @mouseenter="setTimeout(() => { tooltipVisible = true }, tooltipDelay)"
  @mouseleave="tooltipVisible = false"
  class={`relative inline-block ${className}`}
>
  <!-- Trigger element -->
  <slot />
  
  <!-- Tooltip -->
  <div 
    x-show="tooltipVisible"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 scale-95"
    x-transition:enter-end="opacity-100 scale-100"
    x-transition:leave="transition ease-in duration-75"
    x-transition:leave-start="opacity-100 scale-100"
    x-transition:leave-end="opacity-0 scale-95"
    class={`absolute z-50 px-3 py-2 text-sm text-white bg-gray-800 rounded-lg shadow-lg ${positionClasses[position]} ${tooltipClass}`}
    x-cloak
  >
    <span x-text="tooltipText"></span>
    
    <!-- Arrow -->
    {showArrow && (
      <div 
        class={`absolute w-0 h-0 border-4 ${arrowClasses[position]}`}
      ></div>
    )}
  </div>
</div>