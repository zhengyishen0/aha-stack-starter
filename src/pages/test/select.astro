---
import Layout from '../../layouts/Layout.astro';
import Card from '../../components/pine/Card.astro';
import Button from '../../components/pine/Button.astro';
import Badge from '../../components/pine/Badge.astro';
import Select from '../../components/pine/Select.astro';

// Sample data for testing
const countries = [
  { value: 'us', label: 'United States' },
  { value: 'ca', label: 'Canada' },
  { value: 'uk', label: 'United Kingdom' },
  { value: 'de', label: 'Germany' },
  { value: 'fr', label: 'France' },
  { value: 'jp', label: 'Japan' },
  { value: 'au', label: 'Australia' },
  { value: 'br', label: 'Brazil' },
  { value: 'in', label: 'India' },
  { value: 'cn', label: 'China' }
];

const programmingLanguages = [
  { value: 'javascript', label: 'JavaScript' },
  { value: 'typescript', label: 'TypeScript' },
  { value: 'python', label: 'Python' },
  { value: 'java', label: 'Java' },
  { value: 'csharp', label: 'C#' },
  { value: 'cpp', label: 'C++' },
  { value: 'rust', label: 'Rust' },
  { value: 'go', label: 'Go' },
  { value: 'php', label: 'PHP' },
  { value: 'ruby', label: 'Ruby' },
  { value: 'swift', label: 'Swift' },
  { value: 'kotlin', label: 'Kotlin' }
];

const priorities = [
  { value: 'low', label: 'Low Priority' },
  { value: 'medium', label: 'Medium Priority' },
  { value: 'high', label: 'High Priority', disabled: true },
  { value: 'urgent', label: 'Urgent' }
];

const sizes = [
  { value: 'xs', label: 'Extra Small' },
  { value: 's', label: 'Small' },
  { value: 'm', label: 'Medium' },
  { value: 'l', label: 'Large' },
  { value: 'xl', label: 'Extra Large' }
];
---

<Layout title="Select Component Test">
  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold mb-4">Select Component Test</h1>
      <div class="flex justify-center gap-2 mb-6">
        <Button href="/test" variant="outline" color="neutral">‚Üê Back to Test Suite</Button>
        <Button href="/test/all" variant="ghost" color="neutral">View All</Button>
      </div>
    </div>

    <!-- Basic Select Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Basic Select Dropdowns</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 class="text-lg font-semibold mb-4">Standard Select</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Choose a Country</label>
                <Select 
                  options={countries}
                  placeholder="Select a country..."
                  id="country-select"
                  name="country"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Size Selection</label>
                <Select 
                  options={sizes}
                  placeholder="Choose a size..."
                  selectedValue="m"
                  id="size-select"
                  name="size"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Priority Level</label>
                <Select 
                  options={priorities}
                  placeholder="Select priority..."
                  selectedValue="medium"
                  id="priority-select"
                  name="priority"
                />
                <p class="text-xs text-gray-500 mt-1">Note: High Priority option is disabled</p>
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">Disabled Select</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Disabled Empty</label>
                <Select 
                  options={countries}
                  placeholder="Cannot select..."
                  disabled={true}
                  id="disabled-empty"
                  name="disabled-empty"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Disabled with Value</label>
                <Select 
                  options={countries}
                  placeholder="Select a country..."
                  selectedValue="us"
                  disabled={true}
                  id="disabled-value"
                  name="disabled-value"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Searchable Select Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Searchable Select Dropdowns</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 class="text-lg font-semibold mb-4">Programming Languages</h3>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Choose your preferred language</label>
              <Select 
                options={programmingLanguages}
                placeholder="Search for a language..."
                searchable={true}
                selectedValue="javascript"
                id="language-select"
                name="language"
              />
              <p class="text-xs text-gray-500 mt-1">Type to search through the options</p>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">Large Dataset (Countries)</h3>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Search for a country</label>
              <Select 
                options={countries}
                placeholder="Type to search countries..."
                searchable={true}
                id="searchable-country"
                name="searchable-country"
              />
              <p class="text-xs text-gray-500 mt-1">Searchable makes it easy to find options in large lists</p>
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Interactive Demo -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Interactive Demo</h2>
        <div x-data="{ 
          selectedValues: {
            country: '',
            language: '',
            priority: '',
            size: ''
          },
          
          dynamicOptions: [
            { value: 'option1', label: 'Dynamic Option 1' },
            { value: 'option2', label: 'Dynamic Option 2' },
            { value: 'option3', label: 'Dynamic Option 3' }
          ],
          
          addOption() {
            const newOption = {
              value: `option${this.dynamicOptions.length + 1}`,
              label: `Dynamic Option ${this.dynamicOptions.length + 1}`
            };
            this.dynamicOptions.push(newOption);
          },
          
          removeLastOption() {
            if (this.dynamicOptions.length > 1) {
              this.dynamicOptions.pop();
            }
          },
          
          clearAllSelections() {
            this.selectedValues = {
              country: '',
              language: '',
              priority: '',
              size: ''
            };
          }
        }">
          <div class="space-y-6">
            <div class="flex gap-4 mb-6">
              <Button @click="clearAllSelections()" variant="outline" color="red" size="sm">
                Clear All Selections
              </Button>
              <Button @click="addOption()" variant="solid" color="green" size="sm">
                Add Dynamic Option
              </Button>
              <Button @click="removeLastOption()" variant="outline" color="yellow" size="sm">
                Remove Last Option
              </Button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Interactive Country</label>
                <Select 
                  options={countries}
                  placeholder="Select a country..."
                  searchable={true}
                  x-model="selectedValues.country"
                  id="interactive-country"
                  name="interactive-country"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Interactive Language</label>
                <Select 
                  options={programmingLanguages}
                  placeholder="Choose a language..."
                  searchable={true}
                  x-model="selectedValues.language"
                  id="interactive-language"
                  name="interactive-language"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Interactive Priority</label>
                <Select 
                  options={priorities}
                  placeholder="Select priority..."
                  x-model="selectedValues.priority"
                  id="interactive-priority"
                  name="interactive-priority"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Dynamic Options</label>
                <Select 
                  :options="dynamicOptions"
                  placeholder="Select dynamic option..."
                  id="dynamic-select"
                  name="dynamic-select"
                />
                <p class="text-xs text-gray-500 mt-1">
                  Options: <span x-text="dynamicOptions.length"></span>
                </p>
              </div>
            </div>
            
            <!-- Selection Summary -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
              <h4 class="font-semibold mb-3">Current Selections:</h4>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
                <div>Country: <Badge variant="soft" color="blue" size="sm" x-text="selectedValues.country || 'None'"></Badge></div>
                <div>Language: <Badge variant="soft" color="green" size="sm" x-text="selectedValues.language || 'None'"></Badge></div>
                <div>Priority: <Badge variant="soft" color="yellow" size="sm" x-text="selectedValues.priority || 'None'"></Badge></div>
                <div>Size: <Badge variant="soft" color="purple" size="sm" x-text="selectedValues.size || 'None'"></Badge></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Form Integration Example -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Form Integration Example</h2>
        <form x-data="{ 
          formData: {
            country: '',
            language: '',
            experience: '',
            projectType: '',
            budget: '',
            timeline: ''
          },
          
          experienceOptions: [
            { value: 'beginner', label: 'Beginner (0-1 years)' },
            { value: 'intermediate', label: 'Intermediate (2-5 years)' },
            { value: 'advanced', label: 'Advanced (6-10 years)' },
            { value: 'expert', label: 'Expert (10+ years)' }
          ],
          
          projectOptions: [
            { value: 'web', label: 'Web Application' },
            { value: 'mobile', label: 'Mobile Application' },
            { value: 'desktop', label: 'Desktop Application' },
            { value: 'api', label: 'API Development' },
            { value: 'other', label: 'Other' }
          ],
          
          budgetOptions: [
            { value: 'small', label: 'Small ($1k - $5k)' },
            { value: 'medium', label: 'Medium ($5k - $15k)' },
            { value: 'large', label: 'Large ($15k - $50k)' },
            { value: 'enterprise', label: 'Enterprise ($50k+)' }
          ],
          
          timelineOptions: [
            { value: 'rush', label: '1-2 weeks' },
            { value: 'normal', label: '1-3 months' },
            { value: 'extended', label: '3-6 months' },
            { value: 'long', label: '6+ months' }
          ],
          
          submitForm() {
            const missingFields = Object.entries(this.formData)
              .filter(([key, value]) => !value)
              .map(([key]) => key);
            
            if (missingFields.length > 0) {
              alert(`Please fill in the following fields: ${missingFields.join(', ')}`);
              return;
            }
            
            alert('Form submitted successfully!\\n\\n' + JSON.stringify(this.formData, null, 2));
          }
        }" @submit.prevent="submitForm()">
          <div class="space-y-6">
            <h3 class="text-lg font-semibold">Project Requirements Form</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Location and Language -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Country/Region</label>
                <Select 
                  options={countries}
                  placeholder="Select your country..."
                  searchable={true}
                  x-model="formData.country"
                  id="form-country"
                  name="country"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Programming Language</label>
                <Select 
                  options={programmingLanguages}
                  placeholder="Choose primary language..."
                  searchable={true}
                  x-model="formData.language"
                  id="form-language"
                  name="language"
                />
              </div>
              
              <!-- Experience and Project Type -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Experience Level</label>
                <Select 
                  :options="experienceOptions"
                  placeholder="Select your experience..."
                  x-model="formData.experience"
                  id="form-experience"
                  name="experience"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Project Type</label>
                <Select 
                  :options="projectOptions"
                  placeholder="What are you building..."
                  x-model="formData.projectType"
                  id="form-project"
                  name="project_type"
                />
              </div>
              
              <!-- Budget and Timeline -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Budget Range</label>
                <Select 
                  :options="budgetOptions"
                  placeholder="Select budget range..."
                  x-model="formData.budget"
                  id="form-budget"
                  name="budget"
                />
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Timeline</label>
                <Select 
                  :options="timelineOptions"
                  placeholder="Expected timeline..."
                  x-model="formData.timeline"
                  id="form-timeline"
                  name="timeline"
                />
              </div>
            </div>
            
            <!-- Form Actions -->
            <div class="flex gap-4 pt-6 border-t">
              <Button type="submit" variant="solid" color="blue">
                Submit Project Request
              </Button>
              <Button type="button" variant="outline" color="neutral" @click="formData = {}">
                Clear Form
              </Button>
            </div>
          </div>
        </form>
      </div>
    </Card>

    <!-- Keyboard Navigation Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Keyboard Navigation Test</h2>
        <div class="space-y-4">
          <div class="p-4 bg-blue-50 rounded-lg">
            <h4 class="font-semibold mb-2">Keyboard Instructions:</h4>
            <ul class="text-sm text-blue-800 space-y-1">
              <li>‚Ä¢ <strong>Tab:</strong> Focus on the select button</li>
              <li>‚Ä¢ <strong>Enter/Space:</strong> Open dropdown</li>
              <li>‚Ä¢ <strong>Up/Down arrows:</strong> Navigate options</li>
              <li>‚Ä¢ <strong>Enter:</strong> Select highlighted option</li>
              <li>‚Ä¢ <strong>Escape:</strong> Close dropdown</li>
            </ul>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Test Keyboard Navigation</label>
              <Select 
                options={countries}
                placeholder="Use keyboard to navigate..."
                id="keyboard-test"
                name="keyboard-test"
              />
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Searchable + Keyboard</label>
              <Select 
                options={programmingLanguages}
                placeholder="Type to search or use arrows..."
                searchable={true}
                id="keyboard-search-test"
                name="keyboard-search-test"
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Status Summary -->
    <Card>
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Test Results</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">‚úì Working</Badge>
            <p class="text-sm">Basic select functionality</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">‚úì Working</Badge>
            <p class="text-sm">Searchable feature</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">‚úì Working</Badge>
            <p class="text-sm">Keyboard navigation</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">‚úì Working</Badge>
            <p class="text-sm">Form integration</p>
          </div>
        </div>
      </div>
    </Card>
  </main>
</Layout>